Como se trata de venda um porduto deve ser cadastrado no stripe 
1 - clicar em catalogo de produtos
2 - clicar em adiocnar produto 
3 - Definir as informações do produto   
      - Nome do produto   
      - Descrição 
      - foto (eu não vou nusar mas existe essa possibilidade)
      - se o pagamento é recorrente ou se é avulso
      - o valor do produto eo faturamento que pode ser: mensal, anual, trimestral entre outros.
      - no caso de um faturamento mensal o stripe vai contar 30 dias da data do pagamento até o final do plano 
        se o cliente não fizer um novo pagamento os serviço vai ser suspenso.

4 - clicar em adicionar produto   
5 - para adcionar mais preços tem que clicar em aditar o produto
    e clicar em adicionar outro preço definir as condições de faturamento
    clicar em atualizar produto  


Acessando os produtos e colocando nos links

Dento do strpe eu cadastrei um produto com 3 preçose cada um desses preços tem um id 
então no meu .env eu crir uma constante para acada um  

STRIPE_PRODUCT_ID = "prod_TMfflDQPfU9YBW"
STRIPE_MONTHLY_PRICE_ID ="price_1SPwKQ2cCDkaioJGOLWmDf9y"
STRIPE_YEARLY_PRICE_ID = "price_1SPwMx2cCDkaioJGbdHnnYry"
STRIPE_LONGEST_ID ="price_1SPwOm2cCDkaioJGWgubiVxk"

Agora eu tenho uma referencia local dos dados do produto agora e so criar uma rota  
pra receber esse id e tratar ele dentro de um metodo 

Route::get('/plan_selected/{id}',[MainController::class,'planSelected'])->name('plano.selecrionado');

dentro do metodo eu fiz uma array  onde eu coloquei o id do produto e acada um dos preços ligados a ele 

public function planos(){

     $prices=[
          "monthly"=>env('STRIPE_PRODUCT_ID').'|'.env('STRIPE_MONTHLY_PRICE_ID'),
          "yearly"=>env('STRIPE_PRODUCT_ID').'|'.env('STRIPE_YEARLY_PRICE_ID'),
          "longest"=>env('STRIPE_PRODUCT_ID').'|'.env('STRIPE_LONGEST_ID')
     ];

     

     
      
     return view('plans',compact('prices'));
     
    }

Quando a rota é acionada ela envia o array  dando a possibilidade de seleção dos indices entre os links dos 
elementos por exemplo, o elemento abaixo seleciona o indice mounthly que correponde a o ide do preço mensal 
dentro do array:


link 
 <a href="{{ route('plano.selected',['id'=>$prices['monthly']]) }}" class="btn btn-secondary mt-3 w-100">ASSINAR</a>
  
-----------------------------------------------------------------------------------------
array 

     $prices=[
          "monthly"=>env('STRIPE_PRODUCT_ID').'|'.env('STRIPE_MONTHLY_PRICE_ID'),
          "yearly"=>env('STRIPE_PRODUCT_ID').'|'.env('STRIPE_YEARLY_PRICE_ID'),
          "longest"=>env('STRIPE_PRODUCT_ID').'|'.env('STRIPE_LONGEST_ID')
     ];

 ----------------------------------------------------------------------------------    
elemento completo 

           <div class="col-4 p-3">
                <div class="border border-2 rounded-3 border-secondary p-5 text-center">
                    <h3>Plano Mensal</h1>
                    <hr>
                    <h1 class="text-center text-white">9.99$ / mês</h4>
                    <a href="{{ route('plano.selected',['id'=>$prices['monthly']]) }}" class="btn btn-secondary mt-3 w-100">ASSINAR</a>
                </div>
            </div>

-----------------------------------------------------------------------------------

Como o stripe sabe que o cliente comprou um produto, e que produto foi comprado ?

    Foi adicionado no model uma classe chamada "Billable" essa classe vem junto com o 
    stripe quando ele é adicionado ao sistema e essa classe possui alguns metodos que 
    facilitam a manipulação da integração. 

    1- metodo "newSubscription" recebe o id do produto e o  id do preço selecionado 
    ja que o meu porduto tem 3 preços diferentes 

    2 - metodo "trialDays" nesse caso eu coloquei 5 dias de teste mas eu podeia colocar 0 

    3 - metodo "allowPromotionCodes" caso o cliente tenha algm codigo de pormoção eo posso colocar nele 

    4 - metodo "checkout" esse metodo recebe um array com a "success_url" se a requisição der certo e o cliente 
        conseguir finalizar o pagamento e a "cancel_url" se der algum erro ele vai retornar pra ela   
    
     Basicamente a junção desses metodos é como se fosse um formulario com os dados de pagamento que são enviados 
     para a plataforma no fim da execução do metodo chamado pela rota.  

    return auth()->user()
        ->newSubscription($product_id,$price_id)
        ->trialDays(5)
        ->allowPromotionCodes()
        ->checkout([
            'success_url' => route('subscription.success'),
            'cancel_url' => route('planos'),
        ]);
    
    Apagando usuários da plataforma basta ir na aba cliente e selecionar e clicar em excluir 
    mas isso não apaga somente na palataforma o stripe fazx uma reuicição pra dentro da base de 
    dados do sistema e apaga os stripe id de cada usuario deletado.    









