O laravel cashier stripe oferece um grupo de funcionalidades para lidar com pagamento
e gerenciamento de planos, ao instalr o cashier ele tambem traz o stripe.

STRIPE 
  tem varios serviços de cobrança, implantados

CASHIER 
  oferece a interface qua facilita lidar com esses serviços

Embora venham juntos na instalação eles são 2 coisas diferentes 

link da doc "https://laravel.com/docs/12.x/billing"

intalando o stripe 
 composer require laravel/cashier

Apos executar esse comando: " php artisan vendor:publish --tag="cashier-migrations "

O stripe traz algumas migrations depois que executa-las na atebla de usuario seram 
adicionados alguns campos mas o foco deve ser nesses 

1 - stripe_id -> e a identificação do cliente no ambiente stripe
2 - pm_type   -> é o tipo de pagamentoi que cliente vai usar parar apgar pelo plano dele 
3 - pm_last_for -> esse campo contem os 4 ulimos digitos do cartão de crédito do cliente 
4 - trial_ends_at -> é a quantidade de dias de teste do plano caso eu tenha uma assinatura onde o cliente possa testar 

Criando o arquivo de configurações parara o cashier

 php artisan vendor:publish --tag="cashier-config"

Para usar esse serviços eu fiz uma conta no stripe que seria o hub que fornce esses serviçõs de pagamento
na dashboard tem uma area chemada dessenvolvedores e eu tenho que clicar na opção "workbench" 
nessa pagina eu consigo ver o historico de erros na api  e  consigo ver tambem as minhas chaves de teste 


1946341589


no workbench aparecem 2 informações importantes de integração 

1 -chave publicavel 
2 -chave secreta 

e nas configurações do cashier tem 2 espaços para preecher esses dados 
no primeiro espaço fica a chave pulica e na segunda a chave secreta 

 'key' => env('STRIPE_KEY'),

 'secret' => env('STRIPE_SECRET'),

depois de colocfar essas chaves na palicação a proxima etapa e dapatar o model 
de usuários para lidar com isso, para a configurar eu tenho que adicionar um trate 
na classe do model.

TRATE 
 é um conjunto de funcionalidades quq vem inclusas em um arquivo é como se um trate 
 fosse uma contate que representa uma conjunto de metodos, o trate que eu vou adcionar 
 se chama Billable é um trate que só existe se o cashier estiver instalado.

 colcando ele no model eu não preciso saber como a api do cashier funciona eu so preciso
 chamar os metodos e colocar os parametros.



Model com o Billable instalado
--------------------------------------------------------------------------------------
class User extends Authenticatable
{
    /** @use HasFactory<\Database\Factories\UserFactory> */
    use HasFactory, Notifiable,Billable;

    /**
     * The attributes that are mass assignable.
     *
     * @var list<string>
     */
    protected $fillable = [
        'name',
        'email',
        'password',
    ];

    /**
     * The attributes that should be hidden for serialization.
     *
     * @var list<string>
     */
    protected $hidden = [
        'password',
        'remember_token',
    ];

    /**
     * Get the attributes that should be cast.
     *
     * @return array<string, string>
     */
    protected function casts(): array
    {
        return [
            'email_verified_at' => 'datetime',
            'password' => 'hashed',
        ];
    }
}
------------------------------------------------------------------------

Como se trata de um sistema de pagamentos depois que o clite paga ele precisa saber se o pagamento 
foi feito com sucesso pra isso usamos um " webhook " que executa funções de call back onde o stripe
se comunica com o sistema para dar avisos por exemplo 

1 - cliente clica em comprar(stripe recebe o aviso e passa que tem uma pessoa interessada no produto)
2 - cliente faz o cadastro (stripe recebe a ção de cadastro e avisa ao sistema )
3 - cliente paga o plano o stripe recebe e avisa se deu certo ou não o pagamento 

isso acontece sem que eu precise fazer uma consulta manualmente, a instalação do cashier 
criou algumas rotas dentro do sistema são elas 

  GET|HEAD   / ........................................................................................................................  
  GET|HEAD   storage/{path} ............................................................................................. storage.local  
  GET|HEAD   stripe/payment/{id} ........................................... cashier.payment › Laravel\Cashier › PaymentController@show  
  POST       stripe/webhook ....................................... cashier.webhook › Laravel\Cashier › WebhookController@handleWebhook  
  GET|HEAD   up ....................................................................................................................... 

na dashboard do stripe tem na aba de dessenvolvedores tema a aba webhook no caso como a aminha aplicação e local 
existe a opção "Teste com um ouvinbte local" porque a aopção adicionar destino seria parara uma aplicação real.
quando eu escolho essa opção ele moistra uma passo a passo  mas par executar vai se preciso instalar a stripe CLI 
que e a interface compativel com esses comandos 

depois que o cli for baixado tem qua colocar ele na raiz do projeto e depois executar os comandos 
apontando pra ele  depois esecutar comando 1 vai aparecer uma url no terminal que vai pra pagina
de confirmação onde el evai ter certeza de qua login não esta sendo feito por um entruso, apos permitir o acesso 
use o comando 2    

1 - ./stripe login

Nesse caso eu preciso adaptar 

2 - ./stripe listen --forward-to http://localhost/laravel_cashier/public/stripe/webhook

depois que eu executar esse comando ele vai verificar se as cheves da api estão nos luares certos 
a chave publica e a secreta  e vai passar o secret do webhook ela parece com isso eu mudei alguns 
caracteres para não mostrar a original   

whsec_c861e63be5893fe0e7b86c23ea85280ed44nfd05ede585b79fbf6d813f1b708b



3 - ./stripe trigger payment_intent.succeeded
